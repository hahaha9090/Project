{% extends "booking/base_auth.html" %}

{% block title %}注册 - 高校会议室预约管理系统{% endblock %}

{% block content %}
<div class="login-container">
    <div class="login-header">
        <h2><i class="fas fa-user-plus"></i> 用户注册</h2>
        <p>创建您的账户</p>
    </div>
    
    <form method="post">
        {% csrf_token %}
        
        {% if form.non_field_errors %}
            <div class="error-message">
                {% for error in form.non_field_errors %}
                    {{ error }}
                {% endfor %}
            </div>
        {% endif %}
        
        {% for field in form %}
        <div class="form-group">
            <label for="{{ field.id_for_label }}">{{ field.label }}</label>
            <div class="input-group">
                <i class="fas fa-pen"></i>
                {{ field }}
            </div>
            {% if field.help_text %}
            <small style="color: #666; font-size: 0.8rem;">{{ field.help_text|safe }}</small>
            {% endif %}
            {% if field.errors %}
            <small style="color: #c62828; display: block;">{{ field.errors.0 }}</small>
            {% endif %}
        </div>
        {% endfor %}
        
        <button type="submit" class="btn-login" style="background-color: #38a169;">
            注册 <i class="fas fa-check"></i>
        </button>
        
        <div style="text-align: center; margin-top: 15px;">
            <a href="{% url 'login' %}" style="color: #1a2a6c; text-decoration: none; font-size: 0.9rem;">已有账号？立即登录</a>
        </div>
    </form>
    
        <style>
        /* 修复 Django 表单控件样式 */
        .input-group input, .input-group select {
            width: 100%;
            padding: 12px 15px 12px 40px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            box-sizing: border-box;
        }
        /* 隐藏输入框前面的图标，因为这可能导致布局问题，或者需要调整 */
        /* 如果要保留图标，需要给 input 加 padding-left，并确保图标绝对定位 */
        
        .form-group {
            margin-bottom: 15px;
        }

        .helptext {
             display: block;
             font-size: 0.8rem;
             color: #6c757d;
             margin-top: 5px;
        }
        
        .input-group {
            position: relative;
        }
        
        .input-group i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #aaa;
            z-index: 10;
        }
        
        /* 针对不同类型的输入框可能需要调整 */
        .input-group select {
             padding-left: 40px; /* 留出图标位置 */
             appearance: none; /* 移除默认下拉箭头以便统一已样式，或者保留 */
             -webkit-appearance: none;
             -moz-appearance: none;
             background-color: white;
        }
        
    <style>
        /* 覆盖/补充 base_auth.html 中的样式 */
        .input-group input, .input-group select {
            /* 确保覆盖任何可能导致冲突的样式 */
            padding-left: 40px !important;
        }

        /* 为不同的字段设置不同的图标 */
        /* 默认笔形图标已经通过 html 中的 i class="fas fa-pen" 设置了，这里我们通过 css 针对特定字段修改图标类可能会比较复杂，
           因为 Django 循环输出字段。
           更简单的办法是接受统一的图标，或者在 python form 中自定义 widget attrs。
           或者使用 js 动态修改。
           为了简单起见，我们先确保样式整齐。
        */
    </style>
</div>
<script>
    // 简单的脚本来根据字段名更改图标，提升 UI 体验
    document.addEventListener('DOMContentLoaded', function() {
        const fieldIcons = {
            'role': 'fa-users',
            'real_name': 'fa-id-card',
            'student_id': 'fa-id-badge',
            'department': 'fa-building',
            'username': 'fa-user',
            'email': 'fa-envelope',
            'password1': 'fa-lock',
            'password2': 'fa-lock',
        };

        for (const [fieldName, iconClass] of Object.entries(fieldIcons)) {
            const field = document.querySelector(`[name="${fieldName}"]`);
            if (field) {
                const icon = field.parentElement.querySelector('i');
                if (icon) {
                    icon.className = `fas ${iconClass}`;
                }
            }
        }
    });
</script>
{% endblock %}
